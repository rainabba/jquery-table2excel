/*
 *  jQuery table2excel - v1.1.1
 *  jQuery plugin to export an .xls file in browser from an HTML table
 *  https://github.com/rainabba/jquery-table2excel
 *
 *  Made by rainabba
 *  Under MIT License
 */

!function(m,p,d,e){var o="table2excel",n={exclude:".noExl",name:"Table2Excel",filename:"table2excel",fileext:".xls",exclude_img:!0,exclude_links:!0,exclude_inputs:!0,preserveColors:!1,borders:!1,excelFormat:"xls"};function a(e){return null==e?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function i(e){for(var t,o="";0<=e;)t=e%26,o=String.fromCharCode(t+65)+o,e=Math.floor(e/26)-1;return o}function s(e,t){this.element=e,this.settings=m.extend({},n,t),this._defaults=n,this._name=o,this.init()}function h(e){return e.filename?e.filename:"table2excel"}s.prototype={init:function(){var l=this;if(l.settings.borders||"xlsx"===l.settings.excelFormat)l.extractTableDataForXlsx();else{l.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>',sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},l.tableRows=[];var r="",a=null;m(l.element).each(function(e,t){var o,n,s="";m(t).find("tr").not(l.settings.exclude).each(function(e,t){r="",l.settings.preserveColors&&(a=getComputedStyle(t),r+=a&&a.backgroundColor?"background-color: "+a.backgroundColor+";":"",r+=a&&a.color?"color: "+a.color+";":""),s+="<tr style='"+r+"'>",m(t).find("td,th").not(l.settings.exclude).each(function(e,t){r="",l.settings.preserveColors&&(a=getComputedStyle(t),r+=a&&a.backgroundColor?"background-color: "+a.backgroundColor+";":"",r+=a&&a.color?"color: "+a.color+";":"");var o=m(this).attr("rowspan"),n=m(this).attr("colspan");0<m(t).find(l.settings.exclude).length?s+="<td> </td>":(s+="<td",0<o&&(s+=" rowspan='"+o+"' "),0<n&&(s+=" colspan='"+n+"' "),r&&(s+=" style='"+r+"'"),s+=">"+m(t).html()+"</td>")}),s+="</tr>"}),l.settings.exclude_img&&(o=/(\s+alt\s*=\s*"([^"]*)"|\s+alt\s*=\s*'([^']*)')/i,s=s.replace(/<img[^>]*>/gi,function(e){var t=o.exec(e);return null!==t&&2<=t.length?t[2]:""})),l.settings.exclude_links&&(s=s.replace(/<a[^>]*>|<\/a>/gi,"")),l.settings.exclude_inputs&&(n=/(\s+value\s*=\s*"([^"]*)"|\s+value\s*=\s*'([^']*)')/i,s=s.replace(/<input[^>]*>|<\/input>/gi,function(e){var t=n.exec(e);return null!==t&&2<=t.length?t[2]:""})),l.tableRows.push(s)}),l.tableToExcel(l.tableRows,l.settings.name,l.settings.sheetName)}},extractTableDataForXlsx:function(){var s=this,o=[];m(s.element).each(function(e,t){m(t).find("tr").not(s.settings.exclude).each(function(e,t){var n=[];m(t).find("td,th").not(s.settings.exclude).each(function(e,t){if(0<m(t).find(s.settings.exclude).length)n.push(" ");else{var o=m(t).text();s.settings.exclude_img&&(o=o),n.push(o)}}),0<n.length&&o.push(n)})}),s.exportToXlsx(o)},exportToXlsx:function(e){var s=this;if("undefined"==typeof JSZip)return console.error("JSZip library is required for XLSX export. Please include JSZip before using the borders feature."),void alert("JSZip library is required for XLSX export with borders. Please include the JSZip library on your page.");var t,o=new JSZip;o.file("[Content_Types].xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types"><Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/><Default Extension="xml" ContentType="application/xml"/><Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/><Override PartName="/xl/worksheets/sheet1.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/><Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/></Types>'),o.file("_rels/.rels",'<?xml version="1.0" encoding="UTF-8"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>'),o.file("xl/workbook.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"><sheets><sheet name="'+a(s.settings.sheetName||s.settings.name||"Sheet1")+'" sheetId="1" r:id="rId1"/></sheets></workbook>'),o.file("xl/_rels/workbook.xml.rels",'<?xml version="1.0" encoding="UTF-8"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet1.xml"/><Relationship Id="rId2" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/></Relationships>'),o.file("xl/styles.xml",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><fonts count="1"><font><sz val="11"/><name val="Calibri"/></font></fonts><fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills><borders count="2"><border><left/><right/><top/><bottom/></border>'+((t=s.settings.borders)?'<border><left style="thin"><color rgb="FF000000"/></left><right style="thin"><color rgb="FF000000"/></right><top style="thin"><color rgb="FF000000"/></top><bottom style="thin"><color rgb="FF000000"/></bottom></border>':"<border><left/><right/><top/><bottom/></border>")+'</borders><cellXfs count="2"><xf borderId="0" fillId="0" fontId="0" numFmtId="0"/><xf borderId="'+(t?"1":"0")+'" fillId="0" fontId="0" numFmtId="0"'+(t?' applyBorder="1"':"")+"/></cellXfs></styleSheet>"),o.file("xl/worksheets/sheet1.xml",function(e,t){for(var o='<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main"><sheetData>',n=t?"1":"0",s=0;s<e.length;s++){var l=e[s];o+='<row r="'+(s+1)+'">';for(var r=0;r<l.length;r++)o+='<c r="'+(i(r)+(s+1))+'" s="'+n+'" t="inlineStr"><is><t>'+a(l[r])+"</t></is></c>";o+="</row>"}return o+="</sheetData></worksheet>"}(e,s.settings.borders)),o.generateAsync({type:"blob"}).then(function(e){var t=h(s.settings);t.toLowerCase().endsWith(".xlsx")||(t=t.replace(/\.(xls|xlsx)$/i,"")+".xlsx");var o=p.URL.createObjectURL(e),n=d.createElement("a");n.href=o,n.download=t,d.body.appendChild(n),n.click(),d.body.removeChild(n),p.URL.revokeObjectURL(o)})},tableToExcel:function(e,t,o){var n,s,l,r=this,a="";for(n in r.format=function(e,o){return e.replace(/{(\w+)}/g,function(e,t){return o[t]})},o=void 0===o?"Sheet":o,r.ctx={worksheet:t||"Worksheet",table:e,sheetName:o},a=r.template.head,m.isArray(e)&&Object.keys(e).forEach(function(e){a+=r.template.sheet.head+o+e+r.template.sheet.tail}),a+=r.template.mid,m.isArray(e)&&Object.keys(e).forEach(function(e){a+=r.template.table.head+"{table"+e+"}"+r.template.table.tail}),a+=r.template.foot,e)r.ctx["table"+n]=e[n];if(delete r.ctx.table,-1!==navigator.appVersion.indexOf("MSIE 10")||-1!==navigator.userAgent.indexOf("Trident")&&-1!==navigator.userAgent.indexOf("rv:11"))if("undefined"!=typeof Blob){a=[a=r.format(a,r.ctx)];var i=new Blob(a,{type:"text/html"});p.navigator.msSaveBlob(i,h(r.settings))}else txtArea1.document.open("text/html","replace"),txtArea1.document.write(r.format(a,r.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,h(r.settings));else{var c=new Blob([r.format(a,r.ctx)],{type:"application/vnd.ms-excel"});p.URL=p.URL||p.webkitURL,s=p.URL.createObjectURL(c),(l=d.createElement("a")).download=h(r.settings),l.href=s,d.body.appendChild(l),l.click(),d.body.removeChild(l)}return!0}},m.fn[o]=function(e){var t=this;return t.each(function(){m.data(t,"plugin_"+o)||m.data(t,"plugin_"+o,new s(this,e))}),t}}(jQuery,window,document);